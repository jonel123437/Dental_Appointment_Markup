<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Appointment - Dental Appointment System</title>
    <link rel="stylesheet" href="book-appointment.css">
</head>
<body>
    <!-- Fixed Header -->
    <header class="header">
        <div class="header-container">
            <div class="header-brand">
                <div class="logo">ü¶∑</div>
                <div class="brand-text">
                    <h1>Dental Clinic</h1>
                    <p>Appointment System</p>
                </div>
            </div>
            <a href="#" class="back-button" onclick="goBack()">
                <span>‚Üê</span> Back to Dashboard
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Page Header -->
        <div class="page-header">
            <h2>Book Your Dental Appointment</h2>
            <p>Select a date, choose your purpose, and confirm your booking</p>
        </div>

        <!-- Progress Steps -->
        <div class="progress-steps">
            <div class="step active" id="step1">
                <div class="step-circle">1</div>
                <div class="step-label">Select Date</div>
            </div>
            <div class="step" id="step2">
                <div class="step-circle">2</div>
                <div class="step-label">Choose Purpose</div>
            </div>
            <div class="step" id="step3">
                <div class="step-circle">3</div>
                <div class="step-label">Confirm</div>
            </div>
        </div>

        <!-- Booking Card -->
        <div class="booking-card">
            <!-- Step 1: Date Selection -->
            <div class="date-section" id="dateSection">
                <h3 class="section-title">
                    <span>üìÖ</span> Select Appointment Date
                </h3>

                <!-- Calendar -->
                <div class="calendar-header">
                    <div class="month-year" id="monthYear">February 2026</div>
                    <div class="nav-buttons">
                        <button class="nav-btn" onclick="previousMonth()">‚Üê</button>
                        <button class="nav-btn" onclick="nextMonth()">‚Üí</button>
                    </div>
                </div>

                <div class="calendar-grid" id="calendar">
                    <!-- Day headers -->
                    <div class="day-header">Mon</div>
                    <div class="day-header">Tue</div>
                    <div class="day-header">Wed</div>
                    <div class="day-header">Thu</div>
                    <div class="day-header">Fri</div>
                    <div class="day-header">Sat</div>
                    <div class="day-header">Sun</div>
                    <!-- Days will be generated by JavaScript -->
                </div>

                <!-- Legend -->
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-box" style="background: #c6f6d5;"></div>
                        <span>Available</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #fed7d7;"></div>
                        <span>Fully Booked</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: #e2e8f0;"></div>
                        <span>Weekend/Holiday</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                        <span>Selected</span>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="nextToPurpose" onclick="goToPurpose()" disabled>
                        Next: Choose Purpose ‚Üí
                    </button>
                </div>
            </div>

            <!-- Step 2: Purpose Selection -->
            <div class="purpose-section" id="purposeSection">
                <h3 class="section-title">
                    <span>ü¶∑</span> Select Purpose of Visit
                </h3>

                <div class="purpose-options">
                    <div class="purpose-card" onclick="selectPurpose('extraction')">
                        <div class="purpose-icon">ü¶∑</div>
                        <div class="purpose-title">Tooth Extraction</div>
                        <div class="purpose-desc">Removal of damaged or problematic tooth</div>
                    </div>

                    <div class="purpose-card" onclick="selectPurpose('pasta')">
                        <div class="purpose-icon">üîß</div>
                        <div class="purpose-title">Pasta (Temporary Filling)</div>
                        <div class="purpose-desc">Temporary filling for cavity treatment</div>
                    </div>

                    <div class="purpose-card" onclick="selectPurpose('cleaning')">
                        <div class="purpose-icon">‚ú®</div>
                        <div class="purpose-title">Cleaning</div>
                        <div class="purpose-desc">Professional teeth cleaning and checkup</div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="backToDate()">
                        ‚Üê Back
                    </button>
                    <button class="btn btn-primary" id="nextToConfirm" onclick="goToConfirm()" disabled>
                        Next: Review Booking ‚Üí
                    </button>
                </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div class="confirmation-section" id="confirmationSection">
                <h3 class="section-title">
                    <span>‚úÖ</span> Confirm Your Appointment
                </h3>

                <div class="summary-box">
                    <div class="summary-item">
                        <span class="summary-label">üìÖ Date</span>
                        <span class="summary-value" id="confirmDate">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">‚è∞ Time</span>
                        <span class="summary-value">3:00 PM - 5:00 PM</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ü¶∑ Purpose</span>
                        <span class="summary-value"><span class="purpose-badge" id="confirmPurpose">-</span></span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">üìç Location</span>
                        <span class="summary-value">School Dental Clinic<br><small style="font-size: 12px; color: #718096;">Building A, 2nd Floor, Room 205</small></span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">üë§ Student</span>
                        <span class="summary-value">Juan Dela Cruz<br><small style="font-size: 12px; color: #718096;">STU-2024-001</small></span>
                    </div>
                </div>

                <div class="notice-box">
                    <h4>
                        <span>‚ö†Ô∏è</span> Important Reminders
                    </h4>
                    <ul>
                        <li>Please arrive anytime between 3:00 PM - 5:00 PM on your appointment date</li>
                        <li>Students will be served on a first-come, first-served basis</li>
                        <li>You'll receive a confirmation notification with your appointment slip</li>
                        <li>A reminder will be sent 5 hours before your appointment (10:00 AM)</li>
                        <li>You can cancel up to 48 hours before the appointment without penalty</li>
                        <li>Missing your appointment without notice will result in a 6-month booking restriction</li>
                    </ul>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="backToPurpose()">
                        ‚Üê Back
                    </button>
                    <button class="btn btn-primary" onclick="confirmBooking()">
                        ‚úÖ Confirm Booking
                    </button>
                </div>
            </div>

            <!-- Success Message -->
            <div class="success-message" id="successMessage">
                <div class="success-icon">‚úÖ</div>
                <h3>Appointment Confirmed!</h3>
                <p>
                    Your dental appointment has been successfully booked.<br>
                    You'll receive a confirmation notification shortly with your appointment details.<br><br>
                    <strong>Appointment ID: #APT-20260215-001</strong>
                </p>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="location.reload()">
                        Book Another
                    </button>
                    <button class="btn btn-primary" onclick="goToDashboard()">
                        Back to Dashboard
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentDate = new Date();
        let selectedDate = null;
        let selectedPurpose = null;

        // Simulated slot data (in real app, fetch from database)
        const slotData = {
            '2026-02-10': 1, // 1/3 filled
            '2026-02-12': 2, // 2/3 filled
            '2026-02-14': 3, // 3/3 FULL
            '2026-02-17': 0, // 0/3 available
            '2026-02-19': 2, // 2/3 filled
            '2026-02-21': 1, // 1/3 filled
            '2026-02-24': 0, // 0/3 available
            '2026-02-26': 3, // 3/3 FULL
        };

        function generateCalendar() {
            const calendar = document.getElementById('calendar');
            const monthYear = document.getElementById('monthYear');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Update month/year display
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            monthYear.textContent = `${monthNames[month]} ${year}`;
            
            // Clear existing days (keep headers)
            while (calendar.children.length > 7) {
                calendar.removeChild(calendar.lastChild);
            }
            
            // Get first day of month (0 = Sunday, 1 = Monday, etc.)
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Adjust for Monday start (0 = Monday, 6 = Sunday)
            const startDay = firstDay === 0 ? 6 : firstDay - 1;
            
            // Add empty cells for days before month starts
            for (let i = 0; i < startDay; i++) {
                const emptyCell = document.createElement('div');
                calendar.appendChild(emptyCell);
            }
            
            // Add day cells
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateObj = new Date(year, month, day);
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayOfWeek = dateObj.getDay();
                
                const dayCell = document.createElement('div');
                dayCell.className = 'day-cell';
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                
                const slotInfo = document.createElement('div');
                slotInfo.className = 'slot-info';
                
                // Check if weekend (Saturday = 6, Sunday = 0)
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayCell.classList.add('disabled');
                    slotInfo.textContent = 'Weekend';
                }
                // Check if past date
                else if (dateObj < today) {
                    dayCell.classList.add('past');
                    slotInfo.textContent = 'Past';
                }
                // Check slot availability
                else {
                    const slotsUsed = slotData[dateStr] || 0;
                    const slotsAvailable = 3 - slotsUsed;
                    
                    if (slotsUsed >= 3) {
                        dayCell.classList.add('full');
                        slotInfo.textContent = 'Full (3/3)';
                    } else {
                        dayCell.classList.add('available');
                        slotInfo.textContent = `${slotsAvailable}/3 slots`;
                        dayCell.onclick = () => selectDate(dateStr, dateObj);
                    }
                }
                
                dayCell.appendChild(dayNumber);
                dayCell.appendChild(slotInfo);
                calendar.appendChild(dayCell);
            }
        }

        function selectDate(dateStr, dateObj) {
            // Remove previous selection
            document.querySelectorAll('.day-cell.selected').forEach(cell => {
                cell.classList.remove('selected');
            });
            
            // Add selection to clicked cell
            event.target.closest('.day-cell').classList.add('selected');
            
            selectedDate = {
                str: dateStr,
                obj: dateObj
            };
            
            // Enable next button
            document.getElementById('nextToPurpose').disabled = false;
        }

        function selectPurpose(purpose) {
            // Remove previous selection
            document.querySelectorAll('.purpose-card.selected').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            event.target.closest('.purpose-card').classList.add('selected');
            
            selectedPurpose = purpose;
            
            // Enable next button
            document.getElementById('nextToConfirm').disabled = false;
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar();
        }

        function goToPurpose() {
            if (!selectedDate) return;
            
            // Update steps
            document.getElementById('step1').classList.add('completed');
            document.getElementById('step1').classList.remove('active');
            document.getElementById('step2').classList.add('active');
            
            // Hide date section, show purpose section
            document.getElementById('dateSection').style.display = 'none';
            document.getElementById('purposeSection').classList.add('active');
        }

        function backToDate() {
            // Update steps
            document.getElementById('step1').classList.remove('completed');
            document.getElementById('step1').classList.add('active');
            document.getElementById('step2').classList.remove('active');
            
            // Show date section, hide purpose section
            document.getElementById('dateSection').style.display = 'block';
            document.getElementById('purposeSection').classList.remove('active');
        }

        function goToConfirm() {
            if (!selectedPurpose) return;
            
            // Update steps
            document.getElementById('step2').classList.add('completed');
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step3').classList.add('active');
            
            // Update confirmation details
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('confirmDate').textContent = selectedDate.obj.toLocaleDateString('en-US', options);
            
            const purposeNames = {
                'extraction': 'Tooth Extraction',
                'pasta': 'Pasta (Temporary Filling)',
                'cleaning': 'Cleaning'
            };
            document.getElementById('confirmPurpose').textContent = purposeNames[selectedPurpose];
            
            // Hide purpose section, show confirmation section
            document.getElementById('purposeSection').classList.remove('active');
            document.getElementById('confirmationSection').classList.add('active');
        }

        function backToPurpose() {
            // Update steps
            document.getElementById('step2').classList.remove('completed');
            document.getElementById('step2').classList.add('active');
            document.getElementById('step3').classList.remove('active');
            
            // Show purpose section, hide confirmation section
            document.getElementById('purposeSection').classList.add('active');
            document.getElementById('confirmationSection').classList.remove('active');
        }

        function confirmBooking() {
            // In real app: Make AJAX call to save booking to database
            // For demo: Show success message
            
            document.getElementById('step3').classList.add('completed');
            document.getElementById('confirmationSection').style.display = 'none';
            document.getElementById('successMessage').classList.add('active');
        }

        function goToDashboard() {
            window.location.href = 'index.html';
        }

        function goBack() {
            if (confirm('Are you sure you want to leave? Your progress will be lost.')) {
                goToDashboard();
            }
        }

        // Initialize calendar on page load
        generateCalendar();
    </script>
</body>
</html>